* Microsoft COBOL Version 4.5        L2.4 revision 002 28-Oct-13 20:55 Page   1
*                                       EX02.CBL
* Options: LIST(EX02.LST) ASMLIST(EX02.GRP)
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    EX02.
     3 AUTHOR.        LEANDRO & EDEL.
     4 INSTALLATION.  CASA.
     5 DATE-WRITTEN.  09/10/2013.
     6 DATE-COMPILED. 28-Oct-13 20:55.
     7 SECURITY.      APENAS EU POSSO MODIFICAR.
     8*REMARKS.       LE CADENT FAZ O SORTE PELOS VALORES M
     9*               E SALVA NO CADSAI.
    10
    11 ENVIRONMENT DIVISION.
    12 CONFIGURATION SECTION.
    13 SOURCE-COMPUTER. IBM-PC.
    14 OBJECT-COMPUTER. IBM-PC.
    15 SPECIAL-NAMES.   DECIMAL-POINT IS COMMA.
    16
    17 INPUT-OUTPUT SECTION.
    18 FILE-CONTROL.
    19 SELECT CADENT ASSIGN TO DISK ORGANIZATION IS LINE SEQUENTIAL.
    20 SELECT TRAB ASSIGN TO DISK.
    21 SELECT CADSAI ASSIGN TO DISK ORGANIZATION IS LINE SEQUENTIAL.
    22
    23 DATA DIVISION.
    24 FILE SECTION.
    25
    26 FD CADENT
    27   LABEL RECORD ARE STANDARD VALUE OF FILE-ID IS "CADENT.DAT".
    28
    29 01 CAD-ENT.
    30   02 CODIGO-ENT   PIC 9(05).
    31   02 NOME-ENT     PIC X(30).
    32   02 SEXO-ENT     PIC X(01).
    33
    34 SD TRAB.
    35
    36 01 REG-TRAB.
    37   02 CODIGO-TRAB  PIC 9(05).
    38   02 NOME-TRAB    PIC x(30).
    39
    40 FD CADSAI
    41   LABEL RECORD ARE STANDARD VALUE OF FILE-ID IS "CADSAI.DAT".
    42
    43 01 CAD-SAI.
    44   02 CODIGO-SAI   PIC 9(05).
    45   02 NOME-SAI     PIC X(30).
    46
    47 WORKING-STORAGE SECTION.
    48 77 FIM-ARQ        PIC 9(01) VALUE 0.
    49
    50 PROCEDURE DIVISION.
    51 PROGRAMA02.
    52
    53 SORT TRAB
    54      DESCENDING KEY CODIGO-TRAB
    55      INPUT PROCEDURE ROT-ENTRADA
    56      GIVING CADSAI.
    57 STOP RUN.
* Microsoft COBOL Version 4.5        L2.4 revision 002 28-Oct-13 20:55 Page   2
*                                       EX02.CBL
    58
    59 ROT-ENTRADA SECTION.
    60        PERFORM INICIO.
    61        PERFORM PRINCIPAL-ENTRADA UNTIL FIM-ARQ EQUAL 1.
    62        PERFORM FIM.
    63
    64 INICIO SECTION.
    65        OPEN INPUT CADENT.
    66        PERFORM VERIFICA-FIM.
    67
    68 VERIFICA-FIM SECTION.
    69        READ CADENT AT END MOVE 1 TO FIM-ARQ.
    70
    71 PRINCIPAL-ENTRADA SECTION.
    72        PERFORM SELECAO.
    73        PERFORM VERIFICA-FIM.
    74
    75 SELECAO SECTION.
    76        IF SEXO-ENT EQUAL "M" OR "m" PERFORM GRAVACAO.
    77
    78 GRAVACAO SECTION.
    79        MOVE CODIGO-ENT TO CODIGO-TRAB.
    80        MOVE NOME-ENT TO NOME-TRAB.
    81        RELEASE REG-TRAB.
    82
    83 FIM SECTION.
    84        CLOSE CADENT.
* Microsoft COBOL Version 4.5        L2.4 revision 002
* (C)Copyright Microsoft Corp 1984, 1991       URN AXUPA/MS0/000000
*                                              REF GNB-024050002A7
*
* Total Messages:     0
* Data:        1244     Code:         486     Dictionary:        1534
