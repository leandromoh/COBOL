* Microsoft COBOL Version 4.5        L2.4 revision 002 26-Sep-13 13:09 Page   1
*                                       EX01.CBL
* Options: LIST(EX01.LST) ASMLIST(EX01.GRP)
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID. EX01.
     4 AUTHOR. LEANDRO FERNANDES & EDEL CORADI.
     5 INSTALLATION. FATEC-SP.
     6 DATE-WRITTEN. 08/09/2013.
     7 DATE-COMPILED. 26-Sep-13 13:09.
     8 SECURITY.
     9
    10 ENVIRONMENT DIVISION.
    11
    12 CONFIGURATION SECTION.
    13 SOURCE-COMPUTER. IBM-PC.
    14 OBJECT-COMPUTER. IBM-PC.
    15 SPECIAL-NAMES. DECIMAL-POINT IS COMMA.
    16
    17 INPUT-OUTPUT SECTION.
    18 FILE-CONTROL.
    19 SELECT CADSOC1  ASSIGN TO DISK ORGANIZATION IS LINE SEQUENTIAL.
    20 SELECT CADSOC2  ASSIGN TO DISK ORGANIZATION IS LINE SEQUENTIAL.
    21 SELECT RELSOCIO ASSIGN TO DISK.
    22
    23 DATA DIVISION.
    24
    25 FILE SECTION.
    26 FD CADSOC1
    27    LABEL         RECORD         ARE         STANDARD
    28    VALUE       OF FILE-ID       IS        "CADSOC1.DAT".
    29
    30 01 REG-ENT.
    31        02 CODIGO-PAGAMENTO1  PIC 9(2).
    32        02 NUMERO-SOCIO1      PIC 9(6).
    33        02 NOME-SOCIO1        PIC X(30).
    34        02 VALOR-PAGAMENTO1   PIC 9(09)V9(02).
    35
    36 FD CADSOC2
    37    LABEL         RECORD         ARE         STANDARD
    38    VALUE       OF FILE-ID       IS        "CADSOC2.DAT".
    39
    40 01 REG-SAI.
    41        02 NUMERO-SOCIO2      PIC 9(6).
    42        02 NOME-SOCIO2        PIC X(30).
    43        02 VALOR-PAGAMENTO2   PIC 9(09)V9(02).
    44
    45 FD  RELSOCIO
    46     LABEL        RECORD         IS          OMITTED.
    47
    48 01  REG-ATR                  PIC X(80).
    49
    50 WORKING-STORAGE SECTION.
    51
    52 77 FIM-ARQ     PIC 9(01) VALUE 0.
    53 77 CT-LIN      PIC 9(02) VALUE 31.
    54 77 CT-PAG      PIC 9(02) VALUE ZEROES.
    55 77 VALOR-TOTAL PIC 9(12)V9(02) VALUE ZEROES.
    56
    57 01 CAB-01.
* Microsoft COBOL Version 4.5        L2.4 revision 002 26-Sep-13 13:09 Page   2
*                                       EX01.CBL
    58    02 FILLER      PIC X(70) VALUE SPACES.
    59    02 FILLER      PIC X(05) VALUE "PAG. ".
    60    02 VAR-PAG     PIC 99.
    61    02 FILLER      PIC X(03) VALUE SPACES.
    62
    63 01 CAB-02.
    64    02 FILLER    PIC X(26) VALUE SPACES.
    65    02 FILLER    PIC X(27) VALUE "RELAÇÃO DE SÓCIOS ATRASADOS".
    66    02 FILLER    PIC X(27) VALUE SPACES.
    67
    68 01 CAB-03.
    69    02 FILLER    PIC X(05) VALUE SPACES.
    70    02 FILLER    PIC X(15) VALUE "NÚMERO DO SÓCIO".
    71    02 FILLER    PIC X(10) VALUE SPACES.
    72    02 FILLER    PIC X(13) VALUE "NOME DO SÓCIO".
    73    02 FILLER    PIC X(15) VALUE SPACES.
    74    02 FILLER    PIC X(22) VALUE "VALOR DO PAGAMENTO".
    75
    76
    77 01 CAB-04.
    78    02 FILLER      PIC X(05) VALUE SPACES.
    79    02 FILLER      PIC X(28) VALUE "Total de Sócios atrasados : ".
    80    02 TOTAL-SOCIO PIC 9(05) VALUE ZEROES.
    81    02 FILLER      PIC X(42) VALUE SPACES.
    82
    83 01 CAB-05.
    84    02 FILLER           PIC X(05) VALUE SPACES.
    85    02 FILLER           PIC X(23) VALUE "Valor Total atrasado : ".
    86    02 MASC-VALOR-TOTAL PIC ZZZ.ZZZ.ZZZ.ZZ9,99.
    87    02 FILLER           PIC X(34)  VALUE SPACES.
    88
    89 01 DETALHE.
    90    02 FILLER    PIC X(09) VALUE SPACES.
    91    02 NUM       PIC 999.999.
    92    02 FILLER    PIC X(06) VALUE SPACES.
    93    02 NOM       PIC X(30).
    94    02 FILLER    PIC X(08) VALUE SPACES.
    95    02 VAL       PIC ZZZ.ZZZ.ZZ9,99.
    96    02 FILLER    PIC X(06) VALUE SPACES.
    97
    98 PROCEDURE DIVISION.
    99
   100 PROGRAMA05.
   101
   102 PERFORM INICIO.
   103 PERFORM PRINCIPAL UNTIL FIM-ARQ EQUAL 1.
   104 PERFORM CABECALHO-FINAL.
   105 PERFORM TERMINO.
   106
   107 STOP RUN.
   108
   109 INICIO.
   110        OPEN INPUT CADSOC1 OUTPUT CADSOC2 RELSOCIO.
   111        PERFORM VERIFICA-FIM.
   112 VERIFICA-FIM.
   113        READ CADSOC1 AT END MOVE 1 TO FIM-ARQ.
   114 COPIA.
   115        MOVE NUMERO-SOCIO1     TO NUMERO-SOCIO2.
* Microsoft COBOL Version 4.5        L2.4 revision 002 26-Sep-13 13:09 Page   3
*                                       EX01.CBL
   116        MOVE NOME-SOCIO1       TO NOME-SOCIO2.
   117        MOVE VALOR-PAGAMENTO1  TO VALOR-PAGAMENTO2.
   118        WRITE REG-SAI.
   119 IMPRESSAO.
   120        IF CODIGO-PAGAMENTO1 EQUAL 1
   121               PERFORM COPIA
   122        ELSE
   123               IF CT-LIN GREATER THAN 30
   124                      PERFORM CABECALHO
   125               END-IF
   126               PERFORM IMPDET
   127        END-IF.
   128 TERMINO.
   129        CLOSE CADSOC1 CADSOC2 RELSOCIO.
   130 PRINCIPAL.
   131        PERFORM IMPRESSAO.
   132        PERFORM VERIFICA-FIM.
   133 IMPDET.
   134        MOVE NUMERO-SOCIO1    TO NUM.
   135        MOVE NOME-SOCIO1      TO NOM.
   136        MOVE VALOR-PAGAMENTO1 TO VAL.
   137        WRITE REG-ATR FROM DETALHE AFTER ADVANCING 1 LINE.
   138        ADD 1 TO CT-LIN.
   139        ADD 1 TO TOTAL-SOCIO.
   140        ADD VALOR-PAGAMENTO1 TO VALOR-TOTAL.
   141
   142 CABECALHO.
   143        ADD 1 TO CT-PAG.
   144        MOVE CT-PAG TO VAR-PAG.
   145        MOVE SPACES TO REG-ATR.
   146        WRITE REG-ATR AFTER ADVANCING PAGE.
   147        WRITE REG-ATR FROM CAB-01 AFTER ADVANCING 1 LINE.
   148        WRITE REG-ATR FROM CAB-02 AFTER ADVANCING 2 LINES.
   149        WRITE REG-ATR FROM CAB-03 AFTER ADVANCING 2 LINES.
   150        MOVE SPACES TO REG-ATR.
   151        WRITE REG-ATR AFTER ADVANCING 1 LINE.
   152        MOVE 1 TO CT-LIN.
   153
   154 CABECALHO-FINAL.
   155        MOVE SPACES TO REG-ATR.
   156        MOVE VALOR-TOTAL TO MASC-VALOR-TOTAL.
   157        WRITE REG-ATR FROM CAB-04 AFTER ADVANCING 2 LINES.
   158        WRITE REG-ATR FROM CAB-05 AFTER ADVANCING 1 LINE.
* Microsoft COBOL Version 4.5        L2.4 revision 002
* (C)Copyright Microsoft Corp 1984, 1991       URN AXUPA/MS0/000000
*                                              REF GNB-024050002A7
*
* Total Messages:     0
* Data:        1836     Code:         837     Dictionary:        2225
