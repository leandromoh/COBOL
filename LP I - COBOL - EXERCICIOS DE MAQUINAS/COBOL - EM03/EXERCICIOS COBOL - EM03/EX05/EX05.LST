* Microsoft COBOL Version 4.5        L2.4 revision 002 28-Oct-13 21:07 Page   1
*                                       EX05.CBL
* Options: LIST(EX05.LST) ASMLIST(EX05.GRP)
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.   EX05.
     4 AUTHOR.       LEANDRO & EDEL.
     5 INSTALLATION. FATEC-SP.
     6 DATE-WRITTEN. 23/10/13.
     7 DATE-COMPILED. 28-Oct-13 21:07.
     8 SECURITY.
     9
    10 ENVIRONMENT DIVISION.
    11
    12 CONFIGURATION SECTION.
    13 SOURCE-COMPUTER. IBM-PC.
    14 OBJECT-COMPUTER. IBM-PC.
    15 SPECIAL-NAMES.   DECIMAL-POINT IS COMMA.
    16
    17 INPUT-OUTPUT SECTION.
    18 FILE-CONTROL.
    19 SELECT ARQVENDA ASSIGN TO DISK ORGANIZATION IS LINE SEQUENTIAL.
    20 SELECT RELVENDA ASSIGN TO DISK.
    21 SELECT TRAB     ASSIGN TO DISK.
    22
    23 DATA DIVISION.
    24
    25 FILE SECTION.
    26 FD ARQVENDA
    27    LABEL RECORD ARE STANDARD VALUE OF FILE-ID IS "ARQVENDA.DAT".
    28
    29 01 REG-ENT.
    30    02 ESTADO-ENT        PIC X(02).
    31    02 NR-VENDEDOR-ENT   PIC 9(05).
    32    02 NOME-VENDEDOR-ENT PIC X(20).
    33    02 VAL-VENDA-ENT     PIC 9(07)V99.
    34
    35 FD RELVENDA
    36    LABEL RECORD IS OMITTED.
    37
    38 01 REG-ATR              PIC X(80).
    39
    40 SD TRAB.
    41
    42 01 REG-TRAB.
    43    02 ESTADO-TRAB        PIC X(02).
    44    02 NR-VENDEDOR-TRAB   PIC 9(05).
    45    02 NOME-VENDEDOR-TRAB PIC X(20).
    46    02 VAL-VENDA-TRAB     PIC 9(07)V99.
    47
    48 WORKING-STORAGE SECTION.
    49
    50 77 FIM-ARQ           PIC 9(01) VALUE 0.
    51 77 CT-PAG            PIC 9(03) VALUE 0.
    52 77 CT-LIN            PIC 9(02) VALUE 21.
    53 77 ESTADO-ATUAL      PIC X(02).
    54 77 NR-VENDEDOR-ATUAL PIC 9(05).
    55 77 TOTAL-VENDEDOR    PIC 9(07)V99.
    56 77 TOTAL-ESTADO      PIC 9(09)V99.
    57 77 TOTAL-COMPANHIA   PIC 9(12)V99 VALUE 0.
* Microsoft COBOL Version 4.5        L2.4 revision 002 28-Oct-13 21:07 Page   2
*                                       EX05.CBL
    58 77 AUX               PIC 9(01) VALUE 1.
    59 77 ESTADOS           PIC X(19) OCCURS 27 TIMES.
    60 77 INDICE            PIC 9(02).
    61
    62 01 CAB-01.
    63    02 FILLER    PIC X(22) VALUE SPACES.
    64    02 FILLER    PIC X(35) VALUE
    65                "VENDAS TOTAIS POR ESTADO - VENDEDOR".
    66    02 FILLER    PIC X(10) VALUE SPACES.
    67    02 FILLER    PIC X(05) VALUE "PAG. ".
    68    02 VAR-PAG   PIC ZZ9.
    69    02 FILLER    PIC X(05) VALUE SPACES.
    70
    71 01 CAB-02.
    72    02 FILLER       PIC X(01) VALUE SPACES.
    73    02 FILLER       PIC X(08) VALUE "ESTADO: ".
    74    02 ESTADO-REL   PIC X(19).
    75    02 FILLER       PIC X(52) VALUE SPACES.
    76
    77 01 CAB-03.
    78    02 FILLER       PIC X(04) VALUE SPACES.
    79    02 FILLER       PIC X(15) VALUE "NRO DO VENDEDOR".
    80    02 FILLER       PIC X(09) VALUE SPACES.
    81    02 FILLER       PIC X(16) VALUE "NOME DO VENDEDOR".
    82    02 FILLER       PIC X(14) VALUE SPACES.
    83    02 FILLER       PIC X(14) VALUE "VALOR DA VENDA".
    84    02 FILLER       PIC X(08) VALUE SPACES.
    85
    86 01 CAB-04.
    87    02 FILLER          PIC X(35) VALUE SPACES.
    88    02 FILLER          PIC X(18) VALUE "TOTAL DO VENDEDOR:".
    89    02 FILLER          PIC X(03) VALUE SPACES.
    90    02 TOTAL-VEND-REL  PIC ZZZ.ZZZ.ZZ9,99.
    91    02 FILLER          PIC X(10) VALUE SPACES.
    92
    93 01 CAB-05.
    94    02 FILLER          PIC X(35) VALUE SPACES.
    95    02 FILLER          PIC X(16) VALUE "TOTAL DO ESTADO:".
    96    02 FILLER          PIC X(05) VALUE SPACES.
    97    02 TOTAL-EST-REL   PIC ZZZ.ZZZ.ZZ9,99.
    98    02 FILLER          PIC X(10) VALUE SPACES.
    99
   100 01 CAB-06.
   101    02 FILLER          PIC X(35) VALUE SPACES.
   102    02 FILLER          PIC X(19) VALUE "TOTAL DA COMPANHIA:".
   103    02 FILLER          PIC X(02) VALUE SPACES.
   104    02 TOTAL-COMP-REL  PIC ZZZ.ZZZ.ZZ9,99.
   105    02 FILLER          PIC X(10) VALUE SPACES.
   106
   107 01 DETALHE.
   108    02 FILLER          PIC X(08)  VALUE SPACES.
   109    02 NR-REL          PIC ZZZZZ.
   110    02 FILLER          PIC X(14)  VALUE SPACES.
   111    02 NOME-REL        PIC X(20)  VALUE SPACES.
   112    02 FILLER          PIC X(11)  VALUE SPACES.
   113    02 VAL-VENDA-REL   PIC Z.ZZZ.ZZ9,99.
   114    02 FILLER          PIC X(10) VALUE SPACES.
   115
* Microsoft COBOL Version 4.5        L2.4 revision 002 28-Oct-13 21:07 Page   3
*                                       EX05.CBL
   116 PROCEDURE DIVISION.
   117
   118 PROGRAM05.
   119
   120 SORT TRAB
   121      ASCENDING ESTADO-TRAB
   122      ASCENDING NR-VENDEDOR-TRAB
   123      USING ARQVENDA
   124      OUTPUT PROCEDURE GERA-REL.
   125
   126 STOP RUN.
   127
   128 INICIO.
   129        OPEN INPUT ARQVENDA OUTPUT RELVENDA.
   130        PERFORM VERIFICA-FIM.
   131
   132 VERIFICA-FIM.
   133        RETURN TRAB AT END MOVE 1 TO FIM-ARQ.
   134
   135 FIM.
   136     CLOSE ARQVENDA RELVENDA.
   137
   138 PRINCIPAL.
   139
   140        IF ESTADO-ATUAL NOT EQUAL ESTADO-TRAB
   141
   142           IF CT-PAG NOT EQUAL 0
   143              MOVE TOTAL-VENDEDOR TO TOTAL-VEND-REL
   144              WRITE REG-ATR FROM CAB-04 AFTER ADVANCING 2 LINES
   145              MOVE 1 TO AUX
   146              MOVE TOTAL-ESTADO TO TOTAL-EST-REL
   147              ADD  TOTAL-ESTADO TO TOTAL-COMPANHIA
   148              WRITE REG-ATR FROM CAB-05 AFTER ADVANCING 2 LINES
   149           END-IF
   150
   151           MOVE ESTADO-TRAB TO ESTADO-ATUAL
   152           PERFORM PEGA-NOME-ESTADO
   153           MOVE ESTADOS(INDICE) TO ESTADO-REL
   154
   155           MOVE 0 TO TOTAL-VENDEDOR
   156           MOVE 0 TO TOTAL-ESTADO
   157
   158           PERFORM AVANCA-PAGINA
   159           PERFORM CABECALHO
   160
   161        END-IF
   162
   163        IF NR-VENDEDOR-ATUAL NOT EQUAL NR-VENDEDOR-TRAB
   164
   165           IF AUX NOT EQUAL 1
   166              MOVE TOTAL-VENDEDOR TO TOTAL-VEND-REL
   167              WRITE REG-ATR FROM CAB-04 AFTER ADVANCING 2 LINES
   168           END-IF
   169
   170           MOVE 0 TO AUX
   171           MOVE NR-VENDEDOR-TRAB TO NR-VENDEDOR-ATUAL
   172
   173           MOVE NR-VENDEDOR-TRAB   TO NR-REL
* Microsoft COBOL Version 4.5        L2.4 revision 002 28-Oct-13 21:07 Page   4
*                                       EX05.CBL
   174           MOVE NOME-VENDEDOR-TRAB TO NOME-REL
   175           MOVE VAL-VENDA-TRAB     TO VAL-VENDA-REL
   176
   177           WRITE REG-ATR FROM DETALHE AFTER ADVANCING 2 LINES
   178
   179           MOVE VAL-VENDA-TRAB     TO TOTAL-VENDEDOR
   180           MOVE 0                  TO NR-REL
   181           MOVE SPACES             TO NOME-REL
   182
   183           ADD  VAL-VENDA-TRAB     TO TOTAL-ESTADO
   184
   185        ELSE
   186
   187           PERFORM IMPRESSAO
   188
   189        END-IF
   190
   191        PERFORM VERIFICA-FIM.
   192
   193 IMPRESSAO.
   194        IF CT-LIN GREATER THAN 20
   195           PERFORM AVANCA-PAGINA
   196*          PERFORM CABECALHO.
   197        END-IF
   198        PERFORM IMPDET.
   199
   200 IMPDET.
   201        MOVE VAL-VENDA-TRAB TO VAL-VENDA-REL.
   202        ADD  VAL-VENDA-TRAB TO TOTAL-VENDEDOR.
   203        ADD  VAL-VENDA-TRAB TO TOTAL-ESTADO.
   204
   205        WRITE REG-ATR FROM DETALHE AFTER ADVANCING 1 LINE.
   206
   207 CABECALHO.
   208        MOVE CT-PAG TO VAR-PAG.
   209        WRITE REG-ATR FROM CAB-01.
   210        WRITE REG-ATR FROM CAB-02 AFTER ADVANCING 2 LINES.
   211        WRITE REG-ATR FROM CAB-03 AFTER ADVANCING 2 LINES.
   212
   213 AVANCA-PAGINA.
   214        ADD  1 TO CT-PAG.
   215        MOVE 0 TO CT-LIN.
   216        MOVE SPACES TO REG-ATR.
   217        WRITE REG-ATR AFTER ADVANCING PAGE.
   218
   219 CABECALHO-FIM.
   220        MOVE TOTAL-VENDEDOR TO TOTAL-VEND-REL
   221        MOVE TOTAL-ESTADO TO TOTAL-EST-REL
   222        ADD  TOTAL-ESTADO TO TOTAL-COMPANHIA
   223        MOVE TOTAL-COMPANHIA TO TOTAL-COMP-REL.
   224        WRITE REG-ATR FROM CAB-04 AFTER ADVANCING 2 LINES.
   225        WRITE REG-ATR FROM CAB-05 AFTER ADVANCING 2 LINES.
   226        WRITE REG-ATR FROM CAB-06 AFTER ADVANCING 2 LINES.
   227
   228 ALIMENTA-ESTADOS.
   229        MOVE "ACRE"                TO ESTADOS(01).
   230        MOVE "ALAGOAS"             TO ESTADOS(02).
   231        MOVE "AMAPA"               TO ESTADOS(03).
* Microsoft COBOL Version 4.5        L2.4 revision 002 28-Oct-13 21:07 Page   5
*                                       EX05.CBL
   232        MOVE "AMAZONAS"            TO ESTADOS(04).
   233        MOVE "BAHIA"               TO ESTADOS(05).
   234        MOVE "CEARA"               TO ESTADOS(06).
   235        MOVE "DISTRITO FEDERAL"    TO ESTADOS(07).
   236        MOVE "ESPIRITO SANTO"      TO ESTADOS(08).
   237        MOVE "GOIAS"               TO ESTADOS(09).
   238        MOVE "MARANHAO"            TO ESTADOS(10).
   239        MOVE "MATO GROSSO"         TO ESTADOS(11).
   240        MOVE "MATO GROSSO DO SUL"  TO ESTADOS(12).
   241        MOVE "MINAS GERAIS"        TO ESTADOS(13).
   242        MOVE "PARA"                TO ESTADOS(14).
   243        MOVE "PARAIBA"             TO ESTADOS(15).
   244        MOVE "PARANA"              TO ESTADOS(16).
   245        MOVE "PERNAMBUCO"          TO ESTADOS(17).
   246        MOVE "PIAUI"               TO ESTADOS(18).
   247        MOVE "RIO DE JANEIRO"      TO ESTADOS(19).
   248        MOVE "RIO GRANDE DO NORTE" TO ESTADOS(20).
   249        MOVE "RIO GRANDE DO SUL"   TO ESTADOS(21).
   250        MOVE "RONDONIA"            TO ESTADOS(22).
   251        MOVE "RORAIMA"             TO ESTADOS(23).
   252        MOVE "SANTA CATARINA"      TO ESTADOS(24).
   253        MOVE "SAO PAULO"           TO ESTADOS(25).
   254        MOVE "SERGIPE"             TO ESTADOS(26).
   255        MOVE "TOCANTINS"           TO ESTADOS(27).
   256
   257 PEGA-NOME-ESTADO.
   258        IF ESTADO-ATUAL EQUAL "AC" OR "ac" MOVE 01 TO INDICE
   259           NEXT SENTENCE
   260        END-IF
   261        IF ESTADO-ATUAL EQUAL "AL" OR "al" MOVE 02 TO INDICE
   262           NEXT SENTENCE
   263        END-IF
   264        IF ESTADO-ATUAL EQUAL "AP" OR "ap" MOVE 03 TO INDICE
   265           NEXT SENTENCE
   266        END-IF
   267        IF ESTADO-ATUAL EQUAL "AM" OR "am" MOVE 04 TO INDICE
   268           NEXT SENTENCE
   269        END-IF
   270        IF ESTADO-ATUAL EQUAL "BA" OR "ba" MOVE 05 TO INDICE
   271           NEXT SENTENCE
   272        END-IF
   273        IF ESTADO-ATUAL EQUAL "CE" OR "ce" MOVE 06 TO INDICE
   274           NEXT SENTENCE
   275        END-IF
   276        IF ESTADO-ATUAL EQUAL "DF" OR "df" MOVE 07 TO INDICE
   277           NEXT SENTENCE
   278        END-IF
   279        IF ESTADO-ATUAL EQUAL "ES" OR "es" MOVE 08 TO INDICE
   280           NEXT SENTENCE
   281        END-IF
   282        IF ESTADO-ATUAL EQUAL "GO" OR "go" MOVE 09 TO INDICE
   283           NEXT SENTENCE
   284        END-IF
   285        IF ESTADO-ATUAL EQUAL "MA" OR "ma" MOVE 10 TO INDICE
   286           NEXT SENTENCE
   287        END-IF
   288        IF ESTADO-ATUAL EQUAL "MT" OR "mt" MOVE 11 TO INDICE
   289           NEXT SENTENCE
* Microsoft COBOL Version 4.5        L2.4 revision 002 28-Oct-13 21:07 Page   6
*                                       EX05.CBL
   290        END-IF
   291        IF ESTADO-ATUAL EQUAL "MS" OR "ms" MOVE 12 TO INDICE
   292           NEXT SENTENCE
   293        END-IF
   294        IF ESTADO-ATUAL EQUAL "MG" OR "mg" MOVE 13 TO INDICE
   295           NEXT SENTENCE
   296        END-IF
   297        IF ESTADO-ATUAL EQUAL "PA" OR "pa" MOVE 14 TO INDICE
   298           NEXT SENTENCE
   299        END-IF
   300        IF ESTADO-ATUAL EQUAL "PB" OR "pb" MOVE 15 TO INDICE
   301           NEXT SENTENCE
   302        END-IF
   303        IF ESTADO-ATUAL EQUAL "PR" OR "pr" MOVE 16 TO INDICE
   304           NEXT SENTENCE
   305        END-IF
   306        IF ESTADO-ATUAL EQUAL "PE" OR "pe" MOVE 17 TO INDICE
   307           NEXT SENTENCE
   308        END-IF
   309        IF ESTADO-ATUAL EQUAL "PI" OR "pi" MOVE 18 TO INDICE
   310           NEXT SENTENCE
   311        END-IF
   312        IF ESTADO-ATUAL EQUAL "RJ" OR "rj" MOVE 19 TO INDICE
   313           NEXT SENTENCE
   314        END-IF
   315        IF ESTADO-ATUAL EQUAL "RN" OR "rn" MOVE 20 TO INDICE
   316           NEXT SENTENCE
   317        END-IF
   318        IF ESTADO-ATUAL EQUAL "RS" OR "rs" MOVE 21 TO INDICE
   319           NEXT SENTENCE
   320        END-IF
   321        IF ESTADO-ATUAL EQUAL "RO" OR "ro" MOVE 22 TO INDICE
   322           NEXT SENTENCE
   323        END-IF
   324        IF ESTADO-ATUAL EQUAL "RR" OR "rr" MOVE 23 TO INDICE
   325           NEXT SENTENCE
   326        END-IF
   327        IF ESTADO-ATUAL EQUAL "SC" OR "sc" MOVE 24 TO INDICE
   328           NEXT SENTENCE
   329        END-IF
   330        IF ESTADO-ATUAL EQUAL "SP" OR "sp" MOVE 25 TO INDICE
   331           NEXT SENTENCE
   332        END-IF
   333        IF ESTADO-ATUAL EQUAL "SE" OR "se" MOVE 26 TO INDICE
   334           NEXT SENTENCE
   335        END-IF
   336        IF ESTADO-ATUAL EQUAL "TO" OR "to" MOVE 27 TO INDICE
   337           NEXT SENTENCE
   338        END-IF.
   339
   340 GERA-REL SECTION.
   341        PERFORM INICIO.
   342        PERFORM ALIMENTA-ESTADOS.
   343        PERFORM PRINCIPAL UNTIL FIM-ARQ EQUAL 1.
   344        PERFORM CABECALHO-FIM.
   345        PERFORM FIM.
* Microsoft COBOL Version 4.5        L2.4 revision 002
* (C)Copyright Microsoft Corp 1984, 1991       URN AXUPA/MS0/000000
* Microsoft COBOL Version 4.5        L2.4 revision 002 28-Oct-13 21:07 Page   7
*                                       EX05.CBL
*                                              REF GNB-024050002A7
*
* Total Messages:     0
* Data:        2484     Code:        2415     Dictionary:        3084
