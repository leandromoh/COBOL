* Microsoft COBOL Version 4.5        L2.4 revision 002 26-Sep-13 13:21 Page   1
*                                       EX04.CBL
* Options: LIST(EX04.LST) ASMLIST(EX04.GRP)
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID. EX04.
     4 AUTHOR. LEANDRO FERNANDES & EDEL CORADI.
     5 INSTALLATION. FATEC-SP.
     6 DATE-WRITTEN. 09/09/2013.
     7 DATE-COMPILED. 26-Sep-13 13:21.
     8 SECURITY.
     9
    10 ENVIRONMENT DIVISION.
    11
    12 CONFIGURATION SECTION.
    13 SOURCE-COMPUTER. IBM-PC.
    14 OBJECT-COMPUTER. IBM-PC.
    15 SPECIAL-NAMES. DECIMAL-POINT IS COMMA.
    16
    17 INPUT-OUTPUT SECTION.
    18 FILE-CONTROL.
    19 SELECT CADESTOQ ASSIGN TO DISK ORGANIZATION IS LINE SEQUENTIAL.
    20 SELECT RELESTOQ ASSIGN TO DISK.
    21
    22 DATA DIVISION.
    23
    24 FILE SECTION.
    25 FD CADESTOQ
    26    LABEL         RECORD         ARE         STANDARD
    27    VALUE       OF FILE-ID       IS        "CADESTOQ.DAT".
    28
    29 01 REG-ENT.
    30        02 CODIGO         PIC 9(05).
    31        02 NOME           PIC X(15).
    32        02 QTD-ESTOQUE    PIC 9(05).
    33        02 PRECO-UNITARIO PIC 9(06)V99.
    34
    35 FD  RELESTOQ
    36     LABEL        RECORD         IS          OMITTED.
    37
    38 01  REG-ATR                  PIC X(80).
    39
    40 WORKING-STORAGE SECTION.
    41
    42 77 FIM-ARQ     PIC 9(01) VALUE 0.
    43 77 CT-LIN      PIC 9(02) VALUE 26.
    44 77 CT-PAG      PIC 9(02) VALUE ZEROES.
    45 77 CUSTO-TOTAL PIC 9(07)V9(2) VALUE 0.
    46
    47 77 QUTD-TOTAL  PIC 9(07) VALUE 0.
    48 77 PRECO-MEDIO PIC 9(06)V9(2) VALUE 0.
    49 77 PRECO-TOTAL PIC 9(08)V9(2) VALUE 0.
    50
    51 01 CAB-01.
    52    02 FILLER    PIC X(06) VALUE "DATA: ".
    53    02 DIA       PIC 9(02) VALUE 26.
    54    02 FILLER    PIC X(01) VALUE "/".
    55    02 MES       PIC 9(02) VALUE 09.
    56    02 FILLER    PIC X(01) VALUE "/".
    57    02 ANO       PIC 9(04) VALUE 2013.
* Microsoft COBOL Version 4.5        L2.4 revision 002 26-Sep-13 13:21 Page   2
*                                       EX04.CBL
    58    02 FILLER    PIC X(05) VALUE SPACES.
    59    02 FILLER    PIC X(32)
    60              VALUE "RELATÓRIO DE MATERIAL EM ESTOQUE".
    61    02 FILLER    PIC X(18) VALUE SPACES.
    62    02 FILLER    PIC X(05) VALUE "PAG. ".
    63    02 VAR-PAG   PIC 9(03).
    64    02 FILLER    PIC X(02) VALUE SPACES.
    65
    66 01 CAB-02.
    67    02 FILLER    PIC X(06) VALUE "CODIGO".
    68    02 FILLER    PIC X(05) VALUE SPACES.
    69    02 FILLER    PIC X(04) VALUE "NOME".
    70    02 FILLER    PIC X(09) VALUE SPACES.
    71    02 FILLER    PIC X(07) VALUE "QTDE DO".
    72    02 FILLER    PIC X(04) VALUE SPACES.
    73    02 FILLER    PIC X(14) VALUE "CUSTO UNITARIO".
    74    02 FILLER    PIC X(03) VALUE SPACES.
    75    02 FILLER    PIC X(11) VALUE "CUSTO TOTAL".
    76    02 FILLER    PIC X(07) VALUE SPACES.
    77
    78 01 CAB-03.
    79    02 FILLER    PIC X(24) VALUE SPACES.
    80    02 FILLER    PIC X(34) VALUE "ESTOQUE".
    81    02 FILLER    PIC X(22) VALUE SPACES.
    82
    83 01 CAB-04.
    84    02 FILLER    PIC X(16) VALUE "QUANTIDADE TOTAL".
    85    02 FILLER    PIC X(10) VALUE SPACES.
    86    02 FILLER    PIC X(11) VALUE "PREÇO MÉDIO".
    87    02 FILLER    PIC X(06) VALUE SPACES.
    88    02 FILLER    PIC X(11) VALUE "PREÇO TOTAL".
    89    02 FILLER    PIC X(26) VALUE SPACES.
    90
    91 01 CAB-05.
    92    02 FILLER           PIC X(03).
    93    02 QUTD-TOTAL-REL   PIC Z.ZZZ.ZZ9.
    94    02 FILLER           PIC X(12) VALUE SPACES.
    95    02 PRECO-MEDIO-REL  PIC ZZZ.ZZ9,99.
    96    02 FILLER           PIC X(08) VALUE SPACES.
    97    02 PRECO-TOTAL-REL  PIC ZZ.ZZZ.ZZ9,99.
    98
    99 01 DETALHE.
   100    02 CODIGO-REL        PIC 9(05).
   101    02 FILLER            PIC X(02) VALUE SPACES.
   102    02 NOME-REL          PIC X(15).
   103    02 FILLER            PIC X(02) VALUE SPACES.
   104    02 QTD-ESTOQUE-REL   PIC ZZ.ZZ9.
   105    02 FILLER            PIC X(05) VALUE SPACES.
   106    02 CUSTO-UNIT-REL    PIC ZZZ.ZZ9,99.
   107    02 FILLER            PIC X(05) VALUE SPACES.
   108    02 CUSTO-TOTAL-REL   PIC Z.ZZZ.ZZ9,99.
   109
   110 PROCEDURE DIVISION.
   111
   112 PROGRAMA05.
   113
   114 PERFORM INICIO.
   115 PERFORM PRINCIPAL UNTIL FIM-ARQ EQUAL 1.
* Microsoft COBOL Version 4.5        L2.4 revision 002 26-Sep-13 13:21 Page   3
*                                       EX04.CBL
   116 PERFORM FOLHA-SOMATORIA-GERAL.
   117 PERFORM TERMINO.
   118
   119 STOP RUN.
   120
   121 INICIO.
   122        OPEN INPUT CADESTOQ OUTPUT RELESTOQ.
   123        PERFORM VERIFICA-FIM.
   124 VERIFICA-FIM.
   125        READ CADESTOQ AT END MOVE 1 TO FIM-ARQ.
   126 IMPRESSAO.
   127        IF CT-LIN GREATER THAN 25
   128               PERFORM CABECALHO.
   129        PERFORM IMPDET.
   130 TERMINO.
   131        CLOSE CADESTOQ RELESTOQ.
   132 PRINCIPAL.
   133        PERFORM IMPRESSAO.
   134        PERFORM VERIFICA-FIM.
   135 IMPDET.
   136        MOVE NOME    TO NOME-REL.
   137        MOVE CODIGO  TO CODIGO-REL.
   138        MOVE QTD-ESTOQUE TO QTD-ESTOQUE-REL.
   139        MOVE PRECO-UNITARIO TO CUSTO-UNIT-REL.
   140        MULTIPLY QTD-ESTOQUE BY PRECO-UNITARIO
   141                                GIVING CUSTO-TOTAL.
   142        MOVE CUSTO-TOTAL TO CUSTO-TOTAL-REL.
   143        WRITE REG-ATR FROM DETALHE AFTER ADVANCING 1 LINE.
   144        ADD 1 TO CT-LIN.
   145        ADD QTD-ESTOQUE TO QUTD-TOTAL.
   146        ADD CUSTO-TOTAL TO PRECO-TOTAL.
   147 CABECALHO.
   148        ADD 1 TO CT-PAG.
   149        MOVE CT-PAG TO VAR-PAG.
   150        MOVE SPACES TO REG-ATR.
   151        WRITE REG-ATR AFTER ADVANCING PAGE.
   152        WRITE REG-ATR FROM CAB-01 AFTER ADVANCING 1 LINE.
   153        WRITE REG-ATR FROM CAB-02 AFTER ADVANCING 3 LINES.
   154        WRITE REG-ATR FROM CAB-03 AFTER ADVANCING 1 LINE.
   155        MOVE 1 TO CT-LIN.
   156 FOLHA-SOMATORIA-GERAL.
   157        DIVIDE PRECO-TOTAL BY QUTD-TOTAL GIVING PRECO-MEDIO.
   158        MOVE QUTD-TOTAL  TO QUTD-TOTAL-REL.
   159        MOVE PRECO-MEDIO TO PRECO-MEDIO-REL.
   160        MOVE PRECO-TOTAL TO PRECO-TOTAL-REL.
   161        MOVE SPACES TO REG-ATR.
   162        WRITE REG-ATR AFTER ADVANCING PAGE.
   163        WRITE REG-ATR FROM CAB-01 AFTER ADVANCING 1 LINE.
   164        WRITE REG-ATR FROM CAB-04 AFTER ADVANCING 3 LINES.
   165        WRITE REG-ATR FROM CAB-05 AFTER ADVANCING 2 LINES.
* Microsoft COBOL Version 4.5        L2.4 revision 002
* (C)Copyright Microsoft Corp 1984, 1991       URN AXUPA/MS0/000000
*                                              REF GNB-024050002A7
*
* Total Messages:     0
* Data:        1588     Code:         790     Dictionary:        2244
