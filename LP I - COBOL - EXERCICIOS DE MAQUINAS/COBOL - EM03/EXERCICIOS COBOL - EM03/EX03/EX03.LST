* Microsoft COBOL Version 4.5        L2.4 revision 002 28-Oct-13 20:58 Page   1
*                                       EX03.CBL
* Options: LIST(EX03.LST) ASMLIST(EX03.GRP)
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    EXERCICIO3.
     3 AUTHOR.        LEANDRO & EDEL.
     4 INSTALLATION.  CASA.
     5 DATE-WRITTEN.  14/10/2013.
     6 DATE-COMPILED. 28-Oct-13 20:58.
     7 SECURITY.      APENAS O AUTOR PODE MODIFICAR.
     8*REMARKS.       LE CADENT, FAZ UM SORT PELO CAMPO CODIGO
     9*               EM ORDEM ASCENDENTE APENAS DOS DEPARTAMENTOS
    10*               01 E 02.
    11
    12 ENVIRONMENT DIVISION.
    13 CONFIGURATION SECTION.
    14 SOURCE-COMPUTER. IBM-PC.
    15 OBJECT-COMPUTER. IBM-PC.
    16 SPECIAL-NAMES.   DECIMAL-POINT IS COMMA.
    17
    18 INPUT-OUTPUT SECTION.
    19 FILE-CONTROL.
    20 SELECT CADENT ASSIGN TO DISK ORGANIZATION IS LINE SEQUENTIAL.
    21 SELECT TRAB ASSIGN TO DISK.
    22 SELECT CADSAI ASSIGN TO DISK ORGANIZATION IS LINE SEQUENTIAL.
    23
    24 DATA DIVISION.
    25 FILE SECTION.
    26
    27 FD CADENT
    28   LABEL RECORD ARE STANDARD VALUE OF FILE-ID IS "CADENT.DAT".
    29
    30 01 REG-ENT.
    31   02 CODIGO-ENT   PIC 9(05).
    32   02 NOME-ENT     PIC X(30).
    33   02 DEPT-ENT     PIC 9(02).
    34
    35 SD TRAB.
    36
    37 01 REG-TRAB.
    38   02 CODIGO-TRAB  PIC 9(05).
    39   02 NOME-TRAB    PIC X(30).
    40   02 DEPT-TRAB    PIC 9(02).
    41
    42 FD CADSAI
    43   LABEL RECORD ARE STANDARD VALUE OF FILE-ID IS "CADSAI.DAT".
    44
    45 01 REG-SAI.
    46   02 CODIGO-SAI   PIC 9(05).
    47   02 NOME-SAI     PIC X(30).
    48
    49 WORKING-STORAGE SECTION.
    50 77 FIM-ARQ        PIC 9(01) VALUE 0.
    51
    52 PROCEDURE DIVISION.
    53 PROGRAMA03.
    54
    55 SORT TRAB
    56      ASCENDING KEY CODIGO-TRAB
    57      USING CADENT
* Microsoft COBOL Version 4.5        L2.4 revision 002 28-Oct-13 20:58 Page   2
*                                       EX03.CBL
    58      OUTPUT PROCEDURE SAIDA
    59 STOP RUN.
    60
    61 SAIDA SECTION.
    62        PERFORM INICIO.
    63        PERFORM PRINCIPAL UNTIL FIM-ARQ EQUAL 1.
    64        PERFORM FIM.
    65
    66 INICIO SECTION.
    67        OPEN OUTPUT CADSAI.
    68        PERFORM VERIFICA-FIM.
    69
    70 VERIFICA-FIM SECTION.
    71        RETURN TRAB AT END MOVE 1 TO FIM-ARQ.
    72
    73 PRINCIPAL SECTION.
    74        PERFORM SELECAO.
    75        PERFORM VERIFICA-FIM.
    76
    77 SELECAO SECTION.
    78        IF DEPT-TRAB EQUAL 01 OR 02 PERFORM GRAVACAO.
    79
    80 GRAVACAO SECTION.
    81        MOVE CODIGO-TRAB TO CODIGO-SAI.
    82        MOVE NOME-TRAB TO NOME-SAI.
    83        WRITE REG-SAI.
    84
    85 FIM SECTION.
    86        CLOSE CADSAI.
* Microsoft COBOL Version 4.5        L2.4 revision 002
* (C)Copyright Microsoft Corp 1984, 1991       URN AXUPA/MS0/000000
*                                              REF GNB-024050002A7
*
* Total Messages:     0
* Data:        1260     Code:         503     Dictionary:        1560
